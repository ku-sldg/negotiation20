\documentclass[sigconf,authordraft]{acmart}
\usepackage{tikz}
\usetikzlibrary{arrows}

\newcommand{\den}[2][]{
\left\llbracket#2\right\rrbracket^{#1}
}
\newcommand{\low}[1]{
\left\lfloor#1\right\rfloor
}
\newcommand{\denml}[1]{
  \den[ml]{#1}
}
\newcommand{\denev}[1]{
  \den[ev]{#1}
}

\newcommand{\squash}{\itemsep=0pt\parskip=0pt}
\newcommand{\uavam}{\textsf{UAVAM}}
\newcommand{\useram}{\textsf{UserAM}}
\newcommand{\platam}{\textsf{PlatformAM}}
\newcommand{\selam}{\textsf{seL4AM}}
\newcommand{\uboot}{\textsf{UBOOT}}
\newcommand{\duhk}{\textsf{DUHK}}
\newcommand{\M}[1]{\ensuremath{M_{\mathsf{#1}}}}
\newcommand{\E}[1]{\ensuremath{E_{\mathsf{#1}}}}
\newcommand{\R}[1]{\ensuremath{R_{\mathsf{#1}}}}
\newcommand{\sign}[2]{\ensuremath{\{#1\}_{#2^{-1}}}}

%% The article template's documentation, available at
%% \url{https://www.acm.org/publications/proceedings-template}, has a
%% complete explanation of these commands and tips for their effective
%% use.

\setcopyright{acmcopyright}
\copyrightyear{2020}
\acmYear{2020}
\acmDOI{0000}

%% These commands are for a PROCEEDINGS abstract or paper.
\acmConference[Attestation Negotiation]{Working Paper on Attestation
  Negotiation}{20 January, 2020}{Lawrence, KS}
\acmBooktitle{No Book}
\acmPrice{0.00}
\acmISBN{0000}

%%\acmSubmissionID{123-A56-BU3}


\begin{document}

\title{Negotiating Attestation Protocols}

\author{Anna Fritz}
\email{arfritzz@ku.edu}
\author{Perry Alexander}
\orcid{0000-0002-5387-9157}
\email{palexand@ku.edu}
\affiliation{%
  \institution{ITTC - The University of Kansas}
  \streetaddress{2335 Irving Hill Rd}
  \city{Lawrence}
  \state{Kansas}
  \country{USA}
  \postcode{66045}
}

\renewcommand{\shortauthors}{Fritz and Alexander}

\begin{abstract}
  Abstract goes here
\end{abstract}

%%
%% The code below is generated by the tool at http://dl.acm.org/ccs.cfm.
%% Please copy and paste the code instead of the example below.
%%
\begin{CCSXML}
<ccs2012>
 <concept>
  <concept_id>10010520.10010553.10010562</concept_id>
  <concept_desc>Computer systems organization~Embedded systems</concept_desc>
  <concept_significance>500</concept_significance>
 </concept>
 <concept>
  <concept_id>10010520.10010575.10010755</concept_id>
  <concept_desc>Computer systems organization~Redundancy</concept_desc>
  <concept_significance>300</concept_significance>
 </concept>
 <concept>
  <concept_id>10010520.10010553.10010554</concept_id>
  <concept_desc>Computer systems organization~Robotics</concept_desc>
  <concept_significance>100</concept_significance>
 </concept>
 <concept>
  <concept_id>10003033.10003083.10003095</concept_id>
  <concept_desc>Networks~Network reliability</concept_desc>
  <concept_significance>100</concept_significance>
 </concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[500]{Computer systems organization~Embedded systems}
\ccsdesc[300]{Computer systems organization~Redundancy}
\ccsdesc{Computer systems organization~Robotics}
\ccsdesc[100]{Networks~Network reliability}

\keywords{TBD}

\maketitle

\section{Introduction}

\citet{Martin:08:The-ten-page-in} defines trust as unambiguous
identification, unhindered operation, and direct observation of good
behavior or indirect observation by a trusted third party.  Semantic
remote attestation~\cite{Haldar:04:Semantic-Remote} is a technique by
which a target provides evidence used to establish trust in its
execution.  Shown in figure~\ref{fig:architecture-fig} and
\emph{appraiser} makes a request ($r:R$) of a \emph{target} than in
turn generates and returns evidence ($e:E$) that is appraised to
determine trust.

\begin{figure}[hbtp]
  \centering
  \input{architecture-fig.tex}
  \caption[Attestation architecture]{Remote attestation architecture
    showing an \emph{appraiser} making an attestation request of a
    \emph{target}.}
  \Description{Remote attestation basic architecture.}
  \label{fig:architecture-fig}
\end{figure}

\citet{Coker::Principles-of-R,Coker:08:Attestation:-Ev} define a
remote attestation model where a target executes an \emph{attestation
  protocol} that gathers evidence and generates meta-evidence for
appraisal.  The protocol sequences the execution of attestation
services that perform measurement, generate cryptographic signatures,
and make requests of other systems. These protocols are executed by an
\emph{attestation manager} associated with the appraiser or target.

Figure~\ref{fig:sequence-fig} illustrates the process of negotiating
and executing an attestation protocol.  An appraiser and target first
establish a security association that identifies appraiser and target,
sets up secure communication and establishes a security domain
providing context for negotiation.  The appraiser then sends a
request to the target describing the evidence and meta-evidence it
needs for appraisal.  The target produces a proposal consisting of a
protocol set that responds to the request while obeying the target's
local policy.  The appraiser chooses a protocol from the proposal that
the target then executes.  The resulting evidence is returned to the
appraiser and evaluated to determine trust.

The negotiation of an attestation protocol satisfying the
requirements of the appraiser and restrictions of the target is our
objective here.  Following we will formally define a negotiation
process, define properties of an ideal protocol, and show that the
negotiation process produces ideal protocols.  We will then
instantiate the model for several systems to provide examples of its use.

\section{Attestation Protocols}

An attestation protocol is formally a sequence of attestation actions
that can include gathering evidence in sequence and parallel,
generating cryptographic signatures, and requesting attestation
results from other attestation managers.  Our representation for such
protocols uses Copland~\citep{Ramsdell:2019aa} which provides a
convenient language for modeling and execution as well as a formal
semantics for verification.

Figure~\ref{fig:sequence-fig} graphically shows the process we are
formalizing.

$R$ is the type of attestation requests that define the needs of the
appraiser in terms of defined evidence.

$P$ is the type of protocols that represent executable Copland
phrases.  $\langle P \rangle$ is the type of proposals where each
proposal is a sequence of protocols.

$E$ is the type of evidence generated by protocol execution.
$\langle E\rangle$ is the type of potential evidence generated by a
proposal.  Elements of $\langle E\rangle$ are generated by
$(\mathsf{map}\; \mathcal{E}\; \langle P\rangle)$ where $\mathcal{E}$
is the Copland evidence semantics defined by \citet{Ramsdell:2019aa}.
Thus, a proposal can be mapped onto the various evidence that each
protocol produces.

Figure~\ref{fig:sequence-fig} defines the process of protocol
negotiation and execution.  $r:R$ is sent from appraiser to
target.  The target responds with a $q:\langle P\rangle$  defining potential
protocols.  The appraiser chooses one protocol, $p:P$, by direct selection and
instantiation of a parameterized protocol.  That protocol is then
executed by the target and evidence, $e:E$, returned to the appraiser.  The
evidence is then appraised to determine trust.

\begin{figure}[hbtp]
  \centering
  \input{sequence-fig.tex}
  \caption[Attestation process]{Attestation process.}
  \Description{Attestation sequence.}
  \label{fig:sequence-fig}
\end{figure}

\section{Protocol Negotiation}

Figure \ref{fig:certification-fig}.

\begin{figure}[hbtp]
  \centering
  \input{certification-fig.tex}
  \caption[Attestation process]{Certification figure.}
  \Description{Certification figure.}
  \label{fig:certification-fig}
\end{figure}

\section{Conclusions}

We have presented a model for negotiating attestation protocols that
both meet local policy requirements while producing evidence
satisfying appraiser requirements.

\nocite{Coker::Principles-of-R,Ramsdell:2019aa,Petz:2019aa}

\bibliographystyle{ACM-Reference-Format}
\bibliography{sldg}

\end{document}

