\documentclass[12pt]{report}
\usepackage[]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fullpage}
\usepackage{coqdoc}
\usepackage{amsmath,amssymb}
\usepackage{url}
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% This file has been automatically generated with the command
%% coqdoc --latex Manifest_NFM.v 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\coqlibrary{Manifest NFM}{Library }{Manifest\_NFM}

\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Lia}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Relations}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Logic.FunctionalExtensionality}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Lists.List}.\coqdoceol
\coqdocnoindent
\coqdockw{Import} \coqdocvar{ListNotations}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{String}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Cop.Copland}.\coqdoceol
\coqdocnoindent
\coqdockw{Import} \coqdocvar{Copland.Term}.\coqdoceol
\coqdocnoindent
\coqdockw{Require} \coqdockw{Import} \coqdocvar{Utils.Utilities}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
****************************
\section{FORMALIZATION OF ATTESTATION PROTOCOL NEGOTIATION}




  By: Anna Fritz and 
      Dr. Perry Alexander 
  Date: January 6th, 2023


\section{Manifests}


    \coqdocvar{Manifest} defines a single attestation manger and its interconnections.  
    Information includes: 
  asps:  a list of ASPs (measurement operations the AM can preform),
  M : can measure relation (other AMs the current AM knows of),  
  C : context relation (other AMs the current AM depends on),
  Policy : local policy specific to the current AM.
           Minimally includes privacy policy and may possibly include selection policy   


  Other information not necessary for reasoning includes: 
  \coqdocvar{key} simulates public key 
  \coqdocvar{address} simulates address information and 
  \coqdocvar{tpm} simulates cruft necessary to initialize its TPM

\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Record} \coqdocvar{Manifest} := \{\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{1.50em}
\coqdocvar{asps} : \coqdocvar{list} \coqdocvar{ASP} ;\coqdoceol
\coqdocindent{1.50em}
\coqdocvar{K} : \coqdocvar{list} \coqdocvar{Plc} ; \coqdoceol
\coqdocindent{1.50em}
\coqdocvar{C} : \coqdocvar{list} \coqdocvar{Plc} ; \coqdoceol
\coqdocindent{1.50em}
\coqdocvar{Policy} : \coqdocvar{ASP} \ensuremath{\rightarrow} \coqdocvar{Plc} \ensuremath{\rightarrow} \coqdockw{Prop} ;\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocnoindent
\coqdoceol
\coqdocindent{0.50em}
\}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\coqdocvar{Environment} is a set of AM's each defined by a \coqdocvar{Manifest}.
  The domain of an \coqdocvar{Environment} provides names for each \coqdocvar{Manifest}.
  Names should be the hash of their public key, but this restriction
  is not enforced here. 

\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{Environment} : \coqdockw{Type} :=  \coqdocvar{Plc} \ensuremath{\rightarrow} (\coqdocvar{option} \coqdocvar{Manifest}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{e\_empty} : \coqdocvar{Environment} := (\coqdockw{fun} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdocvar{None}).\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{e\_update} (\coqdocvar{m} : \coqdocvar{Environment}) (\coqdocvar{x} : \coqdocvar{Plc}) (\coqdocvar{v} : (\coqdocvar{option} \coqdocvar{Manifest})) :=\coqdoceol
\coqdocindent{2.00em}
\coqdockw{fun} \coqdocvar{x'} \ensuremath{\Rightarrow} \coqdockw{if} \coqdocvar{plc\_dec} \coqdocvar{x} \coqdocvar{x'} \coqdockw{then} \coqdocvar{v} \coqdockw{else} \coqdocvar{m} \coqdocvar{x'}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
A \coqdocvar{System} is all attestation managers in the enviornement 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{System} := \coqdocvar{list} \coqdocvar{Environment}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
****************************
\section{REASONING ABOUT MANIFESTS}




 Within the enviornment \coqdocvar{e}, does the AM at place \coqdocvar{k} have ASP \coqdocvar{a}? 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{hasASPe}(\coqdocvar{k}:\coqdocvar{Plc})(\coqdocvar{e}:\coqdocvar{Environment})(\coqdocvar{a}:\coqdocvar{ASP}):\coqdockw{Prop} :=\coqdoceol
\coqdocnoindent
\coqdockw{match} (\coqdocvar{e} \coqdocvar{k}) \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Some} \coqdocvar{m} \ensuremath{\Rightarrow} \coqdocvar{In} \coqdocvar{a} \coqdocvar{m}.(\coqdocvar{asps})\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Within the system \coqdocvar{s}, does the AM located at place \coqdocvar{k} have ASP \coqdocvar{a}? 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{hasASPs}(\coqdocvar{k}:\coqdocvar{Plc})(\coqdocvar{s}:\coqdocvar{System})(\coqdocvar{a}:\coqdocvar{ASP}):\coqdockw{Prop} :=\coqdoceol
\coqdocindent{2.00em}
\coqdockw{match} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{s1} :: \coqdocvar{s2} \ensuremath{\Rightarrow} (\coqdocvar{hasASPe} \coqdocvar{k} \coqdocvar{s1} \coqdocvar{a}) \ensuremath{\lor} (\coqdocvar{hasASPs} \coqdocvar{k} \coqdocvar{s2} \coqdocvar{a})\coqdoceol
\coqdocindent{2.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Proof that hasASPe is decidable. This means, for any enviornment \coqdocvar{e} 
   either the ASP \coqdocvar{a} is present or it's not. 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{hasASPe\_dec}: \coqdockw{\ensuremath{\forall}} \coqdocvar{k} \coqdocvar{e} \coqdocvar{a}, \{\coqdocvar{hasASPe} \coqdocvar{k} \coqdocvar{e} \coqdocvar{a}\}+\{\~{}\coqdocvar{hasASPe} \coqdocvar{k} \coqdocvar{e} \coqdocvar{a}\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{e} \coqdocvar{a}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{hasASPe}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvar{e} \coqdocvar{k}).\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{induction} (\coqdocvar{asps} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
++ \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
++ \coqdocvar{inverts} \coqdocvar{IHl}.\coqdoceol
\coqdocindent{1.00em}
+++ \coqdoctac{simpl}. \coqdoctac{left}. \coqdoctac{right}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
+++ \coqdoctac{simpl}. \coqdoctac{assert} (\coqdocvar{asp\_dec} : \{\coqdocvar{a} = \coqdocvar{a0}\} + \{\coqdocvar{a}\ensuremath{\not=}\coqdocvar{a0}\}).\coqdoceol
\coqdocindent{5.50em}
\{ \coqdoctac{repeat} \coqdocvar{decide} \coqdocvar{equality}. \}    \coqdoceol
\coqdocindent{3.00em}
\coqdocvar{inverts} \coqdocvar{asp\_dec}.\coqdoceol
\coqdocindent{1.00em}
++++ \coqdoctac{left}. \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
++++ \coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}. \coqdocvar{inverts} \coqdocvar{H1}; \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
prove hasASPs is decidable. This means, for any system \coqdocvar{s} 
   either the ASP \coqdocvar{a} is present or it's not. 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{hasASPs\_dec}: \coqdockw{\ensuremath{\forall}} \coqdocvar{k} \coqdocvar{e} \coqdocvar{a}, \{\coqdocvar{hasASPs} \coqdocvar{k} \coqdocvar{e} \coqdocvar{a}\}+\{\~{}\coqdocvar{hasASPs} \coqdocvar{k} \coqdocvar{e} \coqdocvar{a}\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{e} \coqdocvar{a}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{e}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{simpl} \coqdoctac{in} *. \coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{simpl} \coqdoctac{in} *. \coqdoctac{pose} \coqdocvar{proof} \coqdocvar{hasASPe\_dec} \coqdocvar{k} \coqdocvar{a0} \coqdocvar{a}. \coqdocvar{inverts} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
++ \coqdoctac{left}. \coqdoctac{left}. \coqdoctac{apply} \coqdocvar{H0}.\coqdoceol
\coqdocindent{1.00em}
++ \coqdocvar{inverts} \coqdocvar{IHe}.\coqdoceol
\coqdocindent{1.00em}
+++ \coqdoctac{left}. \coqdoctac{right}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
+++ \coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}. \coqdocvar{inverts} \coqdocvar{H1}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Determine if manifest \coqdocvar{k} from \coqdocvar{e} knows how to 
   communicate from \coqdocvar{k} to \coqdocvar{p}

\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{knowsOfe}(\coqdocvar{k}:\coqdocvar{Plc})(\coqdocvar{e}:\coqdocvar{Environment})(\coqdocvar{p}:\coqdocvar{Plc}):\coqdockw{Prop} :=\coqdoceol
\coqdocnoindent
\coqdockw{match} (\coqdocvar{e} \coqdocvar{k}) \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Some} \coqdocvar{m} \ensuremath{\Rightarrow} \coqdocvar{In} \coqdocvar{p} \coqdocvar{m}.(\coqdocvar{K})\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Print} \coqdocvar{System}.\coqdoceol
\coqdocnoindent
\coqdockw{Print} \coqdocvar{Environment}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Determine if place \coqdocvar{k} within the system \coqdocvar{s} knows of \coqdocvar{p} 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{knowsOfs}(\coqdocvar{k}:\coqdocvar{Plc})(\coqdocvar{s}:\coqdocvar{System})(\coqdocvar{p}:\coqdocvar{Plc}):\coqdockw{Prop} :=\coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{s1} :: \coqdocvar{ss} \ensuremath{\Rightarrow} (\coqdocvar{knowsOfe} \coqdocvar{k} \coqdocvar{s1} \coqdocvar{p}) \ensuremath{\lor} (\coqdocvar{knowsOfs} \coqdocvar{k} \coqdocvar{ss} \coqdocvar{p})\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Prove knowsOfe is decidable. This means, for any enviornment \coqdocvar{e} 
   either the current place \coqdocvar{p} is aware of place \coqdocvar{p} or it's not.  
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{knowsOfe\_dec}:\coqdockw{\ensuremath{\forall}} \coqdocvar{k} \coqdocvar{e} \coqdocvar{p}, \{(\coqdocvar{knowsOfe} \coqdocvar{k} \coqdocvar{e} \coqdocvar{p})\}+\{\~{}(\coqdocvar{knowsOfe} \coqdocvar{k} \coqdocvar{e} \coqdocvar{p})\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{e} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{knowsOfe}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvar{e} \coqdocvar{k}); \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{induction} (\coqdocvar{K} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
++ \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
++ \coqdoctac{assert} (\coqdocvar{H}: \{\coqdocvar{p} = \coqdocvar{a}\} + \{\coqdocvar{p} \ensuremath{\not=} \coqdocvar{a}\}). \{\coqdoctac{repeat} \coqdocvar{decide} \coqdocvar{equality}. \}\coqdoceol
\coqdocindent{2.50em}
\coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
+++ \coqdoctac{simpl}. \coqdoctac{left}. \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
+++ \coqdoctac{simpl}. \coqdocvar{inverts} \coqdocvar{IHl}; \coqdoctac{auto}. \coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}. \coqdocvar{inverts} \coqdocvar{H2}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
decidability of knowsOfs. For any system \coqdocvar{s}, either \coqdocvar{k} knows 
   of \coqdocvar{p} within the system or they do not. 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{knowsOfs\_dec}:\coqdockw{\ensuremath{\forall}} \coqdocvar{k} \coqdocvar{s} \coqdocvar{p}, \{(\coqdocvar{knowsOfs} \coqdocvar{k} \coqdocvar{s} \coqdocvar{p})\}+\{\~{}(\coqdocvar{knowsOfs} \coqdocvar{k} \coqdocvar{s} \coqdocvar{p})\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{s} \coqdocvar{p}.\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{induction} \coqdocvar{s}; \coqdoctac{simpl} \coqdoctac{in} *.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}. \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocindent{2.00em}
+ \coqdoctac{pose} \coqdocvar{proof} \coqdocvar{knowsOfe\_dec} \coqdocvar{k} \coqdocvar{a} \coqdocvar{p}. \coqdocvar{inverts} \coqdocvar{H}.\coqdoceol
\coqdocindent{2.00em}
++ \coqdoctac{left}. \coqdoctac{left}. \coqdoctac{apply} \coqdocvar{H0}.\coqdoceol
\coqdocindent{2.00em}
++ \coqdocvar{inverts} \coqdocvar{IHs}.\coqdoceol
\coqdocindent{2.00em}
+++ \coqdoctac{left}. \coqdoctac{right}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{2.00em}
+++ \coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}. \coqdoctac{inversion} \coqdocvar{H1}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Determine if place \coqdocvar{k} within the environment \coqdocvar{e}  
    depends on place \coqdocvar{p} (the context relation) 
\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{dependsOne} (\coqdocvar{k}:\coqdocvar{Plc})(\coqdocvar{e}:\coqdocvar{Environment})(\coqdocvar{p}:\coqdocvar{Plc}):\coqdockw{Prop} :=\coqdoceol
\coqdocnoindent
\coqdockw{match} (\coqdocvar{e} \coqdocvar{k}) \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Some} \coqdocvar{m} \ensuremath{\Rightarrow} \coqdocvar{In} \coqdocvar{p} \coqdocvar{m}.(\coqdocvar{C})\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Determine if place \coqdocvar{k} within the system \coqdocvar{s} depends on place \coqdocvar{p} (the context relation) 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{dependsOns} (\coqdocvar{k}:\coqdocvar{Plc})(\coqdocvar{s}:\coqdocvar{System})(\coqdocvar{p}:\coqdocvar{Plc}):\coqdockw{Prop} :=\coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{s} \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} [] \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{s1} :: \coqdocvar{ss} \ensuremath{\Rightarrow} (\coqdocvar{dependsOne} \coqdocvar{k} \coqdocvar{s1} \coqdocvar{p}) \ensuremath{\lor} (\coqdocvar{dependsOns} \coqdocvar{k} \coqdocvar{ss} \coqdocvar{p})\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
decidability of dependsOne. For any enviornment \coqdocvar{e}, either the AM at place
   \coqdocvar{k} depends on something at place \coqdocvar{p} or it does not. 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{dependsOne\_dec} : \coqdockw{\ensuremath{\forall}} \coqdocvar{k} \coqdocvar{e} \coqdocvar{p}, \{(\coqdocvar{dependsOne} \coqdocvar{k} \coqdocvar{e} \coqdocvar{p})\}+\{\~{}(\coqdocvar{dependsOne} \coqdocvar{k} \coqdocvar{e} \coqdocvar{p})\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{k} \coqdocvar{e} \coqdocvar{p}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{dependsOne}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} (\coqdocvar{e} \coqdocvar{k}).\coqdoceol
\coqdocindent{1.00em}
+  \coqdoctac{induction} (\coqdocvar{C} \coqdocvar{m}).\coqdoceol
\coqdocindent{1.00em}
++ \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
++ \coqdoctac{simpl}. \coqdoctac{inversion} \coqdocvar{IHl}.\coqdoceol
\coqdocindent{1.00em}
+++  \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
+++ \coqdoctac{assert} (\coqdocvar{H'}: \{\coqdocvar{a} = \coqdocvar{p} \} + \{ \coqdocvar{a} \ensuremath{\not=} \coqdocvar{p}\}). \{\coqdoctac{repeat} \coqdocvar{decide} \coqdocvar{equality}. \} \coqdoctac{inversion} \coqdocvar{H'}.\coqdoceol
\coqdocindent{1.00em}
++++ \coqdoctac{left}. \coqdoctac{left}. \coqdoctac{apply} \coqdocvar{H0}.\coqdoceol
\coqdocindent{1.00em}
++++ \coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}. \coqdoctac{inversion} \coqdocvar{H1}; \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
decidability of dependsOns. For any system \coqdocvar{s}, either the AM at place \coqdocvar{k} depends on something at place \coqdocvar{p} or it does not. 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{dependsOns\_dec} : \coqdockw{\ensuremath{\forall}} \coqdocvar{k} \coqdocvar{s} \coqdocvar{p}, \{\coqdocvar{dependsOns} \coqdocvar{k} \coqdocvar{s} \coqdocvar{p}\} + \{\~{} \coqdocvar{dependsOns} \coqdocvar{k} \coqdocvar{s} \coqdocvar{p}\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros}. \coqdoctac{induction} \coqdocvar{s}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{simpl}. \coqdoctac{auto}.\coqdoceol
\coqdocindent{1.00em}
+ \coqdoctac{simpl}. \coqdoctac{pose} \coqdocvar{proof} \coqdocvar{dependsOne\_dec} \coqdocvar{k} \coqdocvar{a} \coqdocvar{p}. \coqdoctac{inversion} \coqdocvar{IHs}.\coqdoceol
\coqdocindent{1.00em}
++ \coqdoctac{left}. \coqdoctac{right}. \coqdoctac{apply} \coqdocvar{H0}.\coqdoceol
\coqdocindent{1.00em}
++ \coqdoctac{inversion} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
+++ \coqdoctac{left}. \coqdoctac{left}. \coqdoctac{apply} \coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
+++ \coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}. \coqdoctac{inversion} \coqdocvar{H2}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
***************************
\section{EXECUTABILITY}




 Is term \coqdocvar{t} exectuable on the attestation manager named \coqdocvar{k} in 
    environment \coqdocvar{e}?  Are ASPs available at the right attesation managers
    and are necessary communications allowed? 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{executable}(\coqdocvar{t}:\coqdocvar{Term})(\coqdocvar{k}:\coqdocvar{Plc})(\coqdocvar{e}:\coqdocvar{Environment}):\coqdockw{Prop} :=\coqdoceol
\coqdocnoindent
\coqdockw{match} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{asp} \coqdocvar{a}  \ensuremath{\Rightarrow} \coqdocvar{hasASPe} \coqdocvar{k} \coqdocvar{e} \coqdocvar{a}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{att} \coqdocvar{p} \coqdocvar{t} \ensuremath{\Rightarrow} \coqdocvar{knowsOfe} \coqdocvar{k} \coqdocvar{e} \coqdocvar{p} \ensuremath{\rightarrow} \coqdocvar{executable} \coqdocvar{t} \coqdocvar{p} \coqdocvar{e}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{lseq} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} \coqdocvar{executable} \coqdocvar{t1} \coqdocvar{k} \coqdocvar{e} \ensuremath{\land} \coqdocvar{executable} \coqdocvar{t2} \coqdocvar{k} \coqdocvar{e}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{bseq} \coqdocvar{\_} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} \coqdocvar{executable} \coqdocvar{t1} \coqdocvar{k} \coqdocvar{e} \ensuremath{\land} \coqdocvar{executable} \coqdocvar{t2} \coqdocvar{k} \coqdocvar{e}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{bpar} \coqdocvar{\_} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} \coqdocvar{executable} \coqdocvar{t1} \coqdocvar{k} \coqdocvar{e} \ensuremath{\land} \coqdocvar{executable} \coqdocvar{t2} \coqdocvar{k} \coqdocvar{e}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Ltac} \coqdocvar{right\_dest\_contr} \coqdocvar{H} := \coqdoctac{right}; \coqdoctac{unfold} \coqdocvar{not}; \coqdoctac{intros} \coqdocvar{H}; \coqdoctac{destruct} \coqdocvar{H}; \coqdocvar{contradiction}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
executability of a term is decidable 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{executable\_dec}:\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{k} \coqdocvar{e},\{(\coqdocvar{executable} \coqdocvar{t} \coqdocvar{k} \coqdocvar{e})\}+\{\~{}(\coqdocvar{executable} \coqdocvar{t} \coqdocvar{k} \coqdocvar{e})\}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{generalize} \coqdocvar{k}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{intros}.\coqdoceol
\coqdocnoindent
+ \coqdoctac{unfold} \coqdocvar{executable}. \coqdoctac{apply} \coqdocvar{hasASPe\_dec}.\coqdoceol
\coqdocnoindent
+ \coqdoctac{simpl}. \coqdoctac{pose} \coqdocvar{proof} \coqdocvar{knowsOfe\_dec} \coqdocvar{k0} \coqdocvar{e} \coqdocvar{p}. \coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
++ \coqdoctac{destruct} (\coqdocvar{IHt} \coqdocvar{p}).\coqdoceol
\coqdocnoindent
+++ \coqdoctac{left}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
+++ \coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
++ \coqdoctac{destruct} (\coqdocvar{IHt} \coqdocvar{p}).\coqdoceol
\coqdocnoindent
+++ \coqdoctac{left}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
+++ \coqdoctac{left}. \coqdoctac{intros}. \coqdoctac{congruence}.\coqdoceol
\coqdocnoindent
+ \coqdoctac{simpl}. \coqdoctac{specialize} \coqdocvar{IHt1} \coqdockw{with} \coqdocvar{k0}. \coqdoctac{specialize} \coqdocvar{IHt2} \coqdockw{with} \coqdocvar{k0}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{IHt1},\coqdocvar{IHt2}; \coqdoctac{try} \coqdocvar{right\_dest\_contr} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
++ \coqdoctac{left}. \coqdoctac{split} ; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
+ \coqdoctac{simpl}. \coqdoctac{specialize} \coqdocvar{IHt1} \coqdockw{with} \coqdocvar{k0}. \coqdoctac{specialize} \coqdocvar{IHt2} \coqdockw{with} \coqdocvar{k0}. \coqdoctac{destruct} \coqdocvar{IHt1},\coqdocvar{IHt2}; \coqdoctac{try} \coqdocvar{right\_dest\_contr} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
++ \coqdoctac{left}. \coqdoctac{split} ; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
+ \coqdoctac{simpl}. \coqdoctac{specialize} \coqdocvar{IHt1} \coqdockw{with} \coqdocvar{k0}. \coqdoctac{specialize} \coqdocvar{IHt2} \coqdockw{with} \coqdocvar{k0}. \coqdoctac{destruct} \coqdocvar{IHt1},\coqdocvar{IHt2}; \coqdoctac{try} \coqdocvar{right\_dest\_contr} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
++  \coqdoctac{left}. \coqdoctac{split} ; \coqdoctac{assumption}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Is term \coqdocvar{t} executable on the attestation mnanager named \coqdocvar{k} in
  system \coqdocvar{s}?  Are ASPs available at the right attestation managers
  and are necessary communications allowed? 
\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{executables}(\coqdocvar{t}:\coqdocvar{Term})(\coqdocvar{k}:\coqdocvar{Plc})(\coqdocvar{s}:\coqdocvar{System}):\coqdockw{Prop} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{asp} \coqdocvar{a}  \ensuremath{\Rightarrow} \coqdocvar{hasASPs} \coqdocvar{k} \coqdocvar{s} \coqdocvar{a}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{att} \coqdocvar{p} \coqdocvar{t} \ensuremath{\Rightarrow} \coqdocvar{knowsOfs} \coqdocvar{k} \coqdocvar{s} \coqdocvar{p} \ensuremath{\rightarrow} \coqdocvar{executables} \coqdocvar{t} \coqdocvar{p} \coqdocvar{s}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{lseq} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} \coqdocvar{executables} \coqdocvar{t1} \coqdocvar{k} \coqdocvar{s} \ensuremath{\land} \coqdocvar{executables} \coqdocvar{t2} \coqdocvar{k} \coqdocvar{s}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{bseq} \coqdocvar{\_} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} \coqdocvar{executables} \coqdocvar{t1} \coqdocvar{k} \coqdocvar{s} \ensuremath{\land} \coqdocvar{executables} \coqdocvar{t2} \coqdocvar{k} \coqdocvar{s}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{bpar} \coqdocvar{\_} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} \coqdocvar{executables} \coqdocvar{t1} \coqdocvar{k} \coqdocvar{s} \ensuremath{\land} \coqdocvar{executables} \coqdocvar{t2} \coqdocvar{k} \coqdocvar{s}\coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Ltac} \coqdocvar{prove\_exec} :=\coqdoceol
\coqdocindent{2.00em}
\coqdockw{match} \coqdockw{goal} \coqdockw{with}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \ensuremath{\vdash} \{\coqdocvar{executables} (\coqdocvar{asp} \coqdocvar{\_}) \coqdocvar{\_} \coqdocvar{\_}\} + \{\coqdocvar{\_}\} \ensuremath{\Rightarrow} \coqdoctac{unfold} \coqdocvar{executables}; \coqdoctac{apply} \coqdocvar{hasASPs\_dec}\coqdoceol
\coqdocindent{2.00em}
\ensuremath{|} \coqdocvar{IHt1} : \coqdocvar{\_} , \coqdocvar{IHt2} : \coqdocvar{\_} \ensuremath{\vdash} \{\coqdocvar{executables} \coqdocvar{\_} ?\coqdocvar{k} ?\coqdocvar{s}\} + \{\coqdocvar{\_}\} \ensuremath{\Rightarrow} \coqdoctac{simpl}; \coqdoctac{specialize} \coqdocvar{IHt1} \coqdockw{with} \coqdocvar{k} \coqdocvar{s}; \coqdoctac{specialize} \coqdocvar{IHt2} \coqdockw{with} \coqdocvar{k} \coqdocvar{s}; \coqdoctac{destruct} \coqdocvar{IHt1},\coqdocvar{IHt2} ; \coqdoctac{try}( \coqdoctac{left}; \coqdoctac{split} ; \coqdoctac{assumption})\coqdoceol
\coqdocindent{2.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{executables\_dec} : \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{k} \coqdocvar{s}, \{\coqdocvar{executables} \coqdocvar{t} \coqdocvar{k} \coqdocvar{s}\} + \{\~{}\coqdocvar{executables} \coqdocvar{t} \coqdocvar{k} \coqdocvar{s}\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{intros}. \coqdoctac{generalize} \coqdocvar{k} \coqdocvar{s}. \coqdoctac{induction} \coqdocvar{t}; \coqdoctac{intros}; \coqdoctac{try} \coqdocvar{prove\_exec}; \coqdoctac{try} \coqdocvar{right\_dest\_contr} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
+ \coqdoctac{simpl}. \coqdoctac{destruct} (\coqdocvar{IHt} \coqdocvar{p} \coqdocvar{s0}).\coqdoceol
\coqdocnoindent
++ \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
++ \coqdoctac{pose} \coqdocvar{proof} \coqdocvar{knowsOfs\_dec} \coqdocvar{k0} \coqdocvar{s0} \coqdocvar{p}. \coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
+++ \coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}; \coqdoctac{intros}. \coqdoctac{intuition}.\coqdoceol
\coqdocnoindent
+++ \coqdoctac{left}. \coqdoctac{intros}. \coqdoctac{congruence}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
***************************
\section{EXAMPLE SYSTEM}


 

 Motivated by the Flexible Mechanisms for Remote Attestation, 
\section{we have three present parties in this attestation scheme.}


\section{These are used for example purposes.}


 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Notation} \coqdocvar{Rely} := "Rely"\%\coqdocvar{string}.\coqdoceol
\coqdocnoindent
\coqdockw{Notation} \coqdocvar{Target} := "Target"\%\coqdocvar{string}.\coqdoceol
\coqdocnoindent
\coqdockw{Notation} \coqdocvar{Appraise} := "Appraise"\%\coqdocvar{string}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Introducing three asps for testing purposes. 
\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Notation} \coqdocvar{aspc1} :=\coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{ASPC} \coqdocvar{ALL} \coqdocvar{EXTD} (\coqdocvar{asp\_paramsC} "asp1"\%\coqdocvar{string} ["x"\%\coqdocvar{string};"y"\%\coqdocvar{string}] \coqdocvar{Target} \coqdocvar{Target})).\coqdoceol
\coqdocnoindent
\coqdockw{Notation} \coqdocvar{aspc2} :=\coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{ASPC} \coqdocvar{ALL} \coqdocvar{EXTD} (\coqdocvar{asp\_paramsC} "asp2"\%\coqdocvar{string} ["x"\%\coqdocvar{string}] \coqdocvar{Target} \coqdocvar{Target})).\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Below are relational definitions of Policy. Within the definition, we
\section{list each ASP on the AM and state who can recieve a measurement of said}


\section{ASP (ie doesn't expose sensitive information in the context).}


\section{ }


\section{The relying party can share the measurement of aspc1 with p.}


\section{The target can share the measurement aspc2 with the appraiser and SIG}


\section{with anyone. The appraiser can share a hash with anyone.}



\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{rely\_Policy} : \coqdocvar{ASP} \ensuremath{\rightarrow} \coqdocvar{Plc} \ensuremath{\rightarrow} \coqdockw{Prop} := \coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{p\_aspc1} : \coqdockw{\ensuremath{\forall}} \coqdocvar{p}, \coqdocvar{rely\_Policy} \coqdocvar{aspc1} \coqdocvar{p}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{tar\_Policy} : \coqdocvar{ASP} \ensuremath{\rightarrow} \coqdocvar{Plc} \ensuremath{\rightarrow} \coqdockw{Prop} := \coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{p\_aspc2} : \coqdocvar{tar\_Policy} \coqdocvar{aspc2} \coqdocvar{Appraise} \coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{p\_SIG} : \coqdockw{\ensuremath{\forall}} \coqdocvar{p}, \coqdocvar{tar\_Policy} \coqdocvar{SIG} \coqdocvar{p}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Inductive} \coqdocvar{app\_Policy} : \coqdocvar{ASP} \ensuremath{\rightarrow} \coqdocvar{Plc} \ensuremath{\rightarrow} \coqdockw{Prop} := \coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{p\_HSH} : \coqdockw{\ensuremath{\forall}} \coqdocvar{p}, \coqdocvar{app\_Policy} \coqdocvar{HSH} \coqdocvar{p}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Definition of environments for use in examples and proofs.  
\section{Note there are 3 AM's present...}


\section{Relying Party, Target, and Appraiser, each have one AM.}


 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{e0} := \coqdocvar{e\_empty}.\coqdoceol
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{e\_Rely} :=\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{e\_update} \coqdocvar{e\_empty} \coqdocvar{Rely} (\coqdocvar{Some} \{| \coqdocvar{asps} := [\coqdocvar{aspc1}]; \coqdocvar{K}:= [\coqdocvar{Target}] ; \coqdocvar{C} := [] ; \coqdocvar{Policy} := \coqdocvar{rely\_Policy} |\}).\coqdoceol
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{e\_Targ} :=\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{e\_update} \coqdocvar{e\_empty} \coqdocvar{Target} (\coqdocvar{Some} \{| \coqdocvar{asps} := [\coqdocvar{SIG};  \coqdocvar{aspc2}]; \coqdocvar{K}:= [\coqdocvar{Appraise}] ; \coqdocvar{C} := [] ; \coqdocvar{Policy} := \coqdocvar{tar\_Policy}|\}).\coqdoceol
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{e\_App} :=\coqdoceol
\coqdocindent{2.00em}
\coqdocvar{e\_update} \coqdocvar{e\_empty} \coqdocvar{Appraise} (\coqdocvar{Some} \{| \coqdocvar{asps} := [\coqdocvar{HSH}] ; \coqdocvar{K}:= [] ; \coqdocvar{C} := [\coqdocvar{Target}] ; \coqdocvar{Policy} := \coqdocvar{app\_Policy} |\}).\coqdoceol
\coqdocemptyline
\end{coqdoccode}
In our example, the system includes the relying party, the target,
\section{and the appraiser}


 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{example\_sys\_1} := [\coqdocvar{e\_Rely}; \coqdocvar{e\_Targ}; \coqdocvar{e\_App}].\coqdoceol
\coqdocemptyline
\end{coqdoccode}
***************************
\section{EXAMPLE SYSTEM PROPERTIES}


  

 Prove the relying party has aspc1 in the relying party's enviornement 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex1}: \coqdocvar{hasASPe} \coqdocvar{Rely} \coqdocvar{e\_Rely} \coqdocvar{aspc1}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{unfold} \coqdocvar{hasASPe}. \coqdoctac{simpl}. \coqdoctac{left}. \coqdoctac{reflexivity}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
relying party does not have the ASP copy
 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex2}: \coqdocvar{hasASPe} \coqdocvar{Rely} \coqdocvar{e\_Rely} \coqdocvar{CPY} \ensuremath{\rightarrow} \coqdocvar{False}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{unfold} \coqdocvar{hasASPe}. \coqdoctac{simpl}. \coqdoctac{intros}. \coqdocvar{inverts} \coqdocvar{H}. \coqdocvar{inverts} \coqdocvar{H0}. \coqdoctac{auto}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Prove the Relying party has aspc2 within the system
 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex3}: \coqdocvar{hasASPs} \coqdocvar{Rely} (\coqdocvar{example\_sys\_1}) \coqdocvar{aspc1}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdoctac{unfold} \coqdocvar{hasASPs}. \coqdoctac{unfold} \coqdocvar{hasASPe}. \coqdoctac{simpl}. \coqdoctac{left}. \coqdoctac{left}. \coqdoctac{reflexivity}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
the relying party knows of the target within system 1
 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex4}: \coqdocvar{knowsOfs} \coqdocvar{Rely} \coqdocvar{example\_sys\_1} \coqdocvar{Target}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{knowsOfs}. \coqdoctac{simpl}. \coqdoctac{left}. \coqdoctac{unfold} \coqdocvar{knowsOfe}. \coqdoctac{simpl}. \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
the relying party does not directly know of the appraiser
 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex5}: \coqdocvar{knowsOfe} \coqdocvar{Rely} \coqdocvar{e\_App} \coqdocvar{Appraise} \ensuremath{\rightarrow} \coqdocvar{False}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{knowsOfe}. \coqdoctac{simpl}. \coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{H}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
the relying party does not knows of the appraiser within the system... 
\section{should be that the relying party knows of the target and the target}


\section{knows of the appraiser....}


 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex5'}: \coqdocvar{knowsOfs} \coqdocvar{Rely} \coqdocvar{example\_sys\_1} \coqdocvar{Appraise} \ensuremath{\rightarrow} \coqdocvar{False}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{knowsOfs}. \coqdoctac{simpl}. \coqdoctac{unfold} \coqdocvar{knowsOfe}. \coqdoctac{simpl}. \coqdoctac{intros}. \coqdocvar{inverts} \coqdocvar{H}. \coqdocvar{inverts} \coqdocvar{H0}. \coqdocvar{inverts} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{H}. \coqdocvar{inverts} \coqdocvar{H0}. \coqdoctac{apply} \coqdocvar{H}. \coqdocvar{inverts} \coqdocvar{H}. \coqdoctac{apply} \coqdocvar{H0}. \coqdoctac{apply} \coqdocvar{H0}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
the relying party is aware of the target in system 1 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex6}: \coqdocvar{knowsOfs} \coqdocvar{Rely} \coqdocvar{example\_sys\_1} \coqdocvar{Target}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{knowsOfs},\coqdocvar{knowsOfe}. \coqdoctac{simpl}. \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
if the relying party was it's own system, it would still be aware of
\section{the target}


 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex7}: \coqdocvar{knowsOfs} \coqdocvar{Rely} [\coqdocvar{e\_Rely}] \coqdocvar{Target}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{knowsOfs},\coqdocvar{knowsOfe}. \coqdoctac{simpl}. \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
the appriser depends on target 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex8} : \coqdocvar{dependsOne} \coqdocvar{Appraise} \coqdocvar{e\_App} \coqdocvar{Target}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocnoindent
\coqdoctac{unfold} \coqdocvar{dependsOne}. \coqdoctac{simpl}. \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
within the system, we see that the appraiser depends on target 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex9} : \coqdocvar{dependsOns} \coqdocvar{Appraise} \coqdocvar{example\_sys\_1} \coqdocvar{Target}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{dependsOns}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{dependsOne}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Proof tactic for executability
 
\begin{coqdoccode}
\coqdocnoindent
\coqdockw{Ltac} \coqdocvar{prove\_exec'} :=\coqdoceol
\coqdocindent{2.00em}
\coqdoctac{simpl}; \coqdoctac{auto}; \coqdockw{match} \coqdockw{goal} \coqdockw{with}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \ensuremath{\vdash} \coqdocvar{hasASPe} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdoctac{cbv}; \coqdoctac{left}; \coqdoctac{reflexivity}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \ensuremath{\vdash} \coqdocvar{knowsOfe} \coqdocvar{\_} \coqdocvar{\_} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdoctac{unfold} \coqdocvar{knowsOfe}; \coqdoctac{simpl}; \coqdoctac{left}; \coqdoctac{reflexivity}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \ensuremath{\vdash} \coqdocvar{\_} \ensuremath{\land} \coqdocvar{\_} \ensuremath{\Rightarrow} \coqdoctac{split}; \coqdocvar{prove\_exec'}\coqdoceol
\coqdocindent{8.50em}
\ensuremath{|} \ensuremath{\vdash} ?\coqdocvar{A} \ensuremath{\Rightarrow} \coqdoctac{idtac} \coqdocvar{A}\coqdoceol
\coqdocindent{8.50em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Is asp SIG executable on the on target place in the Targets's
\section{enviornement?}


 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex10}: (\coqdocvar{executable} (\coqdocvar{asp} \coqdocvar{SIG}) \coqdocvar{Target} \coqdocvar{e\_Targ}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdocvar{prove\_exec'}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
copy is not executable on the target in the appraiser's environment
 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex11}: (\coqdocvar{executable} (\coqdocvar{asp} \coqdocvar{CPY}) \coqdocvar{Target} \coqdocvar{e\_App}) \ensuremath{\rightarrow} \coqdocvar{False}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{Hcontra}; \coqdoctac{cbv} \coqdoctac{in} *; \coqdoctac{destruct} \coqdocvar{Hcontra}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
two signature operations are executable on the target
 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex12}: (\coqdocvar{executable} (\coqdocvar{lseq} (\coqdocvar{asp} \coqdocvar{SIG}) (\coqdocvar{asp} \coqdocvar{SIG})) \coqdocvar{Target} \coqdocvar{e\_Targ}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}. \coqdocvar{prove\_exec'}. \coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
the relying party can ask the target to run aspc1 and signature
\section{operations within system 1}


 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Example} \coqdocvar{ex13}: (\coqdocvar{executables} (\coqdocvar{lseq} (\coqdocvar{asp} \coqdocvar{aspc1})\coqdoceol
\coqdocindent{14.00em}
(\coqdocvar{att} \coqdocvar{Target}\coqdoceol
\coqdocindent{16.00em}
(\coqdocvar{lseq} (\coqdocvar{asp} \coqdocvar{SIG})\coqdoceol
\coqdocindent{16.00em}
(\coqdocvar{asp} \coqdocvar{SIG}))))\coqdoceol
\coqdocindent{8.00em}
\coqdocvar{Rely} \coqdocvar{example\_sys\_1}).\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdocvar{prove\_exec'}; \coqdoctac{cbv}; \coqdoctac{auto}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Print} \coqdocvar{relation}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{string\_dec}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{s} \coqdocvar{s'}:\coqdocvar{string}), \{\coqdocvar{s}=\coqdocvar{s'}\}+\{\coqdocvar{s}\ensuremath{\not=}\coqdocvar{s'}\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{s} \coqdocvar{s'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{repeat} \coqdocvar{decide} \coqdocvar{equality}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{plc\_dec}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{p} \coqdocvar{p'}:\coqdocvar{Plc}),\{\coqdocvar{p}=\coqdocvar{p'}\}+\{\coqdocvar{p}\ensuremath{\not=}\coqdocvar{p'}\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{p} \coqdocvar{p'}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{string\_dec}.\coqdoceol
\coqdocnoindent
\coqdockw{Defined}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Check} \coqdocvar{ASP\_dec}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
A proof that \coqdocvar{tar\_Policy} is decidable.  If we can show all policies are
\section{decidable, life is good.  This is a start.}


 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{tar\_Policy\_dec}: \coqdockw{\ensuremath{\forall}} (\coqdocvar{asp}:\coqdocvar{ASP})(\coqdocvar{plc}:\coqdocvar{Plc}), \{(\coqdocvar{tar\_Policy} \coqdocvar{asp} \coqdocvar{plc})\}+\{\~{}(\coqdocvar{tar\_Policy} \coqdocvar{asp} \coqdocvar{plc})\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{asp}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{plc}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{asp}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdocvar{inverts} \coqdocvar{Hneg}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdocvar{inverts} \coqdocvar{Hneg}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\{(\coqdocvar{ASPC} \coqdocvar{s} \coqdocvar{f} \coqdocvar{a})=\coqdocvar{aspc2}\} + \{(\coqdocvar{ASPC} \coqdocvar{s} \coqdocvar{f} \coqdocvar{a})<>\coqdocvar{aspc2}\}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{ASP\_dec}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\{(\coqdocvar{plc} = "Appraise"\%\coqdocvar{string})\} + \{(\coqdocvar{plc} \ensuremath{\not=} "Appraise"\%\coqdocvar{string})\}).\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{apply} \coqdocvar{plc\_dec}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H}; \coqdoctac{destruct} \coqdocvar{H0}. \coqdoctac{subst}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{rewrite} \coqdocvar{e}. \coqdoctac{apply} \coqdocvar{p\_aspc2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{rewrite} \coqdocvar{e}. \coqdoctac{unfold} \coqdocvar{not} \coqdoctac{in} *. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdoctac{apply} \coqdocvar{n}. \coqdoctac{inversion} \coqdocvar{Hneg}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not} \coqdoctac{in} *. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdoctac{apply} \coqdocvar{n}. \coqdoctac{inversion} \coqdocvar{Hneg}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not} \coqdoctac{in} *. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdoctac{apply} \coqdocvar{n}. \coqdoctac{inversion} \coqdocvar{Hneg}. \coqdoctac{reflexivity}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{apply} \coqdocvar{p\_SIG}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not} \coqdoctac{in} *. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdocvar{inverts} \coqdocvar{Hneg}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{checkASPPolicy}(\coqdocvar{p}:\coqdocvar{Plc})(\coqdocvar{e}:\coqdocvar{Environment})(\coqdocvar{a}:\coqdocvar{ASP}):\coqdockw{Prop} :=\coqdoceol
\coqdocnoindent
\coqdockw{match} (\coqdocvar{e} \coqdocvar{p}) \coqdockw{with} \coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{None} \ensuremath{\Rightarrow} \coqdocvar{False}\coqdoceol
\coqdocnoindent
\ensuremath{|} \coqdocvar{Some} \coqdocvar{m} \ensuremath{\Rightarrow} (\coqdocvar{Policy} \coqdocvar{m} \coqdocvar{a} \coqdocvar{p}) \coqdoceol
\coqdocnoindent
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Fixpoint} \coqdocvar{checkTermPolicy}(\coqdocvar{t}:\coqdocvar{Term})(\coqdocvar{k}:\coqdocvar{Plc})(\coqdocvar{e}:\coqdocvar{Environment}):\coqdockw{Prop} :=\coqdoceol
\coqdocindent{1.00em}
\coqdockw{match} \coqdocvar{t} \coqdockw{with}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{asp} \coqdocvar{a}  \ensuremath{\Rightarrow} \coqdocvar{checkASPPolicy} \coqdocvar{k} \coqdocvar{e} \coqdocvar{a}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{att} \coqdocvar{r} \coqdocvar{t0} \ensuremath{\Rightarrow} \coqdocvar{checkTermPolicy} \coqdocvar{t0} \coqdocvar{k} \coqdocvar{e}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{lseq} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} \coqdocvar{checkTermPolicy} \coqdocvar{t1} \coqdocvar{k} \coqdocvar{e} \ensuremath{\land} \coqdocvar{checkTermPolicy} \coqdocvar{t2} \coqdocvar{k} \coqdocvar{e}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{bseq} \coqdocvar{\_} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} \coqdocvar{checkTermPolicy} \coqdocvar{t1} \coqdocvar{k} \coqdocvar{e} \ensuremath{\land} \coqdocvar{checkTermPolicy} \coqdocvar{t2} \coqdocvar{k} \coqdocvar{e}\coqdoceol
\coqdocindent{1.00em}
\ensuremath{|} \coqdocvar{bpar} \coqdocvar{\_} \coqdocvar{t1} \coqdocvar{t2} \ensuremath{\Rightarrow} \coqdocvar{checkTermPolicy} \coqdocvar{t1} \coqdocvar{k} \coqdocvar{e} \ensuremath{\land} \coqdocvar{checkTermPolicy} \coqdocvar{t2} \coqdocvar{k} \coqdocvar{e}\coqdoceol
\coqdocindent{1.00em}
\coqdockw{end}.\coqdoceol
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{checkTermPolicy\_dec}:\coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{k} \coqdocvar{e},\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{p0} \coqdocvar{e0} \coqdocvar{a0}, \{(\coqdocvar{checkASPPolicy} \coqdocvar{p0} \coqdocvar{e0} \coqdocvar{a0})\} + \{\~{}(\coqdocvar{checkASPPolicy} \coqdocvar{p0} \coqdocvar{e0} \coqdocvar{a0})\}) \ensuremath{\rightarrow}\coqdoceol
\coqdocindent{2.00em}
\{(\coqdocvar{checkTermPolicy} \coqdocvar{t} \coqdocvar{k} \coqdocvar{e})\}+\{\~{}(\coqdocvar{checkTermPolicy} \coqdocvar{t} \coqdocvar{k} \coqdocvar{e})\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{k} \coqdocvar{e}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{induction} \coqdocvar{t}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}. \coqdoctac{assumption}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}; \coqdoctac{destruct} \coqdocvar{IHt1},\coqdocvar{IHt2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{split}; \coqdoctac{assumption}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdoctac{destruct} \coqdocvar{Hneg}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdoctac{destruct} \coqdocvar{Hneg}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdoctac{destruct} \coqdocvar{Hneg}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}; \coqdoctac{destruct} \coqdocvar{IHt1},\coqdocvar{IHt2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{split}; \coqdoctac{assumption}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdoctac{destruct} \coqdocvar{Hneg}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdoctac{destruct} \coqdocvar{Hneg}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdoctac{destruct} \coqdocvar{Hneg}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{simpl}; \coqdoctac{destruct} \coqdocvar{IHt1},\coqdocvar{IHt2}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{split}; \coqdoctac{assumption}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdoctac{destruct} \coqdocvar{Hneg}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdoctac{destruct} \coqdocvar{Hneg}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros} \coqdocvar{Hneg}. \coqdoctac{destruct} \coqdocvar{Hneg}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Soundness is executability and policy adherence 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Definition} \coqdocvar{sound} (\coqdocvar{t}:\coqdocvar{Term})(\coqdocvar{k}:\coqdocvar{Plc})(\coqdocvar{e}:\coqdocvar{Environment}) :=\coqdoceol
\coqdocindent{1.00em}
(\coqdocvar{executable} \coqdocvar{t} \coqdocvar{k} \coqdocvar{e}) \ensuremath{\land} (\coqdocvar{checkTermPolicy} \coqdocvar{t} \coqdocvar{k} \coqdocvar{e}).\coqdoceol
\coqdocemptyline
\end{coqdoccode}
Prove soundness is decidable with the assumption necessary for policy
\section{adherence decidability.}


 
\begin{coqdoccode}
\coqdocemptyline
\coqdocnoindent
\coqdockw{Theorem} \coqdocvar{sound\_dec}: \coqdockw{\ensuremath{\forall}} \coqdocvar{t} \coqdocvar{p} \coqdocvar{e},\coqdoceol
\coqdocindent{2.00em}
(\coqdockw{\ensuremath{\forall}} \coqdocvar{p0} \coqdocvar{e0} \coqdocvar{a0}, \{(\coqdocvar{checkASPPolicy} \coqdocvar{p0} \coqdocvar{e0} \coqdocvar{a0})\} + \{\~{}(\coqdocvar{checkASPPolicy} \coqdocvar{p0} \coqdocvar{e0} \coqdocvar{a0})\})\coqdoceol
\coqdocindent{2.00em}
\ensuremath{\rightarrow} \{\coqdocvar{sound} \coqdocvar{t} \coqdocvar{p} \coqdocvar{e}\}+\{\~{}(\coqdocvar{sound} \coqdocvar{t} \coqdocvar{p} \coqdocvar{e})\}.\coqdoceol
\coqdocnoindent
\coqdockw{Proof}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{t} \coqdocvar{p} \coqdocvar{e}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{intros} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{unfold} \coqdocvar{sound}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\{\coqdocvar{executable} \coqdocvar{t} \coqdocvar{p} \coqdocvar{e}\}+\{\~{}(\coqdocvar{executable} \coqdocvar{t} \coqdocvar{p} \coqdocvar{e})\}). \coqdoctac{apply} \coqdocvar{executable\_dec}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{assert} (\{\coqdocvar{checkTermPolicy} \coqdocvar{t} \coqdocvar{p} \coqdocvar{e}\}+\{\~{}(\coqdocvar{checkTermPolicy} \coqdocvar{t} \coqdocvar{p} \coqdocvar{e})\}). \coqdoctac{apply} \coqdocvar{checkTermPolicy\_dec}. \coqdoctac{intros}. \coqdoctac{apply} \coqdocvar{H}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{destruct} \coqdocvar{H0},\coqdocvar{H1}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{left}. \coqdoctac{split}; \coqdoctac{assumption}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{H0}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{H0}. \coqdocvar{contradiction}.\coqdoceol
\coqdocindent{1.00em}
\coqdoctac{right}. \coqdoctac{unfold} \coqdocvar{not}. \coqdoctac{intros}. \coqdoctac{destruct} \coqdocvar{H0}. \coqdocvar{contradiction}.\coqdoceol
\coqdocnoindent
\coqdockw{Qed}.\coqdoceol
\coqdocemptyline
\end{coqdoccode}
\end{document}
